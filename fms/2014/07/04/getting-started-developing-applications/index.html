
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>getting started developing applications  </title>
   <meta name="author" content="lsj" />

   <link rel="start" href="/" />

	
	
	
  	<link rel="alternate" type="application/atom+xml" href="http://feeds.feedburner.com/feedname" title="RSS feed" />
	
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/assets/themes/mark-reid/css/screen.css" type="text/css" />

</head>

<body id="">


<div id="header" >
    <h1>
    	<a href="/" title="alonepig's blog" >alonepig's blog</a>
		<!--     	<span class="byline">&larr; <a href="/">lsj</a></span> -->
    </h1>
    <ul class="nav">
      <li><a class="home" href="/">Home</a></li>
      <li><a  href="/archive.html">Archive</a></li>
      <li><a  href="/pages.html">Pages</a></li>
      <li><a  href="/categories.html">Categories</a></li>
      <li><a  href="/tags.html">Tags</a></li>
      <li><a  href="/about.html">About</a></li>
    </ul>
  </div>
</div>

<div id="left">

     <strong>Tag Clound</strong><br />
     <div class="navbar1" >
     	
    		<a href="tags.html#intro-ref" id="1" class="__tag" style="margin: 5px">intro</a>
  		
    		<a href="tags.html#beginner-ref" id="2" class="__tag" style="margin: 5px">beginner</a>
  		
    		<a href="tags.html#jekyll-ref" id="3" class="__tag" style="margin: 5px">jekyll</a>
  		
    		<a href="tags.html#tutorial-ref" id="4" class="__tag" style="margin: 5px">tutorial</a>
  		
    		<a href="tags.html#FMS-ref" id="5" class="__tag" style="margin: 5px">FMS</a>
  		
     </div>
     
<!-- 	<strong>Blogroll</strong><br /> -->
<!-- 	<div class="navbar1" > -->
<!--      	<ul > -->
<!--      		<li><a href="" target="_blank" ><span >github.com</span></a></li> -->
<!--      	</ul> -->
<!-- 	</div> -->
	
	<!--
	<strong>Find Me</strong><br />
	<div class="navbar1" >
	<ul >
          <li><a href="https://github.com/alonepig" target="_blank" title="Github"><span class="fa fa-github fa-lg">Github</span></a></li>
          <li><a href="http://www.douban.com/people/alonepig" target="_blank" title="douban"><span>豆瓣</span></a></li>
          <li><a href="http://www.zhihu.com/people/alonepig" target="_blank" ><span>知乎</span></a></li>
     </ul>
     </div>
     
     -->
</div>


<div id="site">
  
  
<div id="page">
	
  <h1 class="emphnext">getting started developing applications</h1>
  <ul class="tag_box inline">
  
  


  
     
    	<li><a href="/tags.html#FMS-ref">FMS <span>12</span></a></li>
    
  



  </ul>

  <h4>开始开发应用</h4>

<h5>应用结构</h5>

<p>典型的AMS应用有以下部分：</p>

<p><strong>Client</strong> 客户端显示用户界面，如控制视频的播放、停止。</p>

<p><strong>Client-side ActionScript</strong> </p>

<p><strong>Video or audio files</strong></p>

<p><strong>Camera or Microphone</strong></p>

<p><strong>Server-Side ActionScript</strong></p>

<h5>设置开发环境</h5>

<p>你可以使用任何版本的AMS来开发和测试应用。为了写客户端代码，可以使用Flash Professional，Flash Builder等。
任何文本编辑器写服务器端代码。</p>

<p><strong>设置开发环境:</strong></p>

<p>1、安装AMS</p>

<p>2、验证是否安装成功</p>

<p>3、安装Flash Professional或Flash Builder或Flex SDK</p>

<p>4、捕获和编码视频</p>

<p>a 连接一个摄像头或麦克风</p>

<p>b 下载和安装Adobe Media Live Encoder</p>

<h5>实例：Hello World应用</h5>

<h6>概要</h6>

<p><strong>提示：</strong> 以下内容不能在Adobe Media Streaming Server中使用，因为你不能在这个版本上写服务器端代码</p>

<p>这个例子展示了客户端的简单通讯。实例文件在rootinstall/documentation/samples/Hello World文件夹。</p>

<h6>写用户接口</h6>

<h6>写客户端脚本</h6>

<p>package {
import flash.display.MovieClip;
import flash.net.Responder;
import flash.net.NetConnection;
import flash.events.NetStatusEvent;
import flash.events.MouseEvent;
public class HelloWorld extends MovieClip {</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">public function HelloWorld() {
    textLbl.text = &quot;&quot;;
    connectBtn.label = &quot;Connect&quot;;
    connectBtn.addEventListener(MouseEvent.CLICK, connectHandler);
}

public function connectHandler(event:MouseEvent):void {
    if (connectBtn.label == &quot;Connect&quot;) {
        trace(&quot;Connecting...&quot;);
        nc = new NetConnection();
        // Connect to the server.
        nc.connect(&quot;rtmp://localhost/HelloWorld&quot;);
        // Call the server&#39;s client function serverHelloMsg, in HelloWorld.asc.
        nc.call(&quot;serverHelloMsg&quot;, myResponder, &quot;World&quot;);
        connectBtn.label = &quot;Disconnect&quot;;
    } else {
        trace(&quot;Disconnecting...&quot;);
        // Close the connection.
        nc.close();
        connectBtn.label = &quot;Connect&quot;;
        textLbl.text = &quot;&quot;;
    }
}

private function onReply(result:Object):void {
    trace(&quot;onReply received value: &quot; + result);
    textLbl.text = String(result);
}
</code></pre></div>
<p>}
}</p>

<h6>写服务器端脚本</h6>
<div class="highlight"><pre><code class="language-text" data-lang="text">application.onConnect = function( client ) {
    client.serverHelloMsg = function( helloStr ) {
    return &quot;Hello, &quot; + helloStr + &quot;!&quot;;
}
application.acceptConnection( client );
}
</code></pre></div>
<h6>编译和运行应用</h6>

<p>1、运行服务器</p>

<p>2、编译客户端文件</p>

<p>3、测试。</p>

<h5>创建应用的概要</h5>

<h6>客户端代码</h6>

<h6>服务器端代码</h6>

<p>一般来说，有如下需求的时候服务器端需要写代码：</p>

<p><strong>Authenticate clients</strong> 权限验证</p>

<p><strong>Implement connection logic</strong> 实现连接的逻辑</p>

<p><strong>Update clients</strong> 通过调用远程方法来更新客户端的共享数据</p>

<p><strong>Connect to other server</strong>  向某个应用或数据库调用web service或socket</p>

<p>服务器端的代码入口为main.asc或yourApplicationName.asc。</p>

<p>该文件应在应用的主目录中，或scripts子目录中。</p>

<p>rootinstall/applications/appName</p>

<p>rootinstall/applications/appName/scripts</p>

<p>默认情况下，应用文件夹在安装目录的的applications文件中，也可以在fms.ini或Vhost.xml文件中设置VHOST.APPSDIR。
在Vhost.xml文件中，编辑AppsDir。</p>

<h5>测试应用</h5>

<h6>测试和调试客户端脚本</h6>

<h6>测试和调试服务器端脚本</h6>

<p>使用trace()，输出相关数据。日志信息也会保存在rootinstall/logs/<em>defaultVHost</em>/yourApplicationName/yourInstanceName/application.xx.log文件中</p>

<p>使用管理员控制台。修改.asc文件之后，需要重启应用才会生效。</p>

<p><strong>使用管理员控制台调试</strong></p>

<p>可调式行和可调试会话数由Application.xml配置文件的AllowDebugDefault和MaxPendingDebugConnections决定。默认情况下，是不可调试的。
也可以使用服务器端代码开启调试：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">application.allowDebug = true;
</code></pre></div>
<h5>部署应用</h5>

<h6>注册应用</h6>
<div class="highlight"><pre><code class="language-text" data-lang="text">myNetConnection.connect(&quot;rtmp://fms.examples.com/myApplication&quot;);
</code></pre></div>
<h6>复制服务器端脚本文件到服务器</h6>

<h6>复制多媒体文件</h6>

<h6>复制客户端文件到web服务器</h6>


  <address class="signature">
    <a class="author" href="/">lsj</a> 
    <span class="date">04 July 2014</span>
    <span class="location"></span>
  </address>
  
  
	<div class='cloud'>
		<a style='font-size: 70%' href='/tags.html#intro'>intro</a>
<a style='font-size: 170%' href='/tags.html#FMS'>FMS</a>
<a style='font-size: 70%' href='/tags.html#tutorial'>tutorial</a>
<a style='font-size: 70%' href='/tags.html#jekyll'>jekyll</a>
<a style='font-size: 70%' href='/tags.html#beginner'>beginner</a>

	</div>
	
  <div class="prev-next">
  
    <a href="/fms/2014/07/07/building-peer-assisted-networking-applications" class="next" title="building peer assisted networking applications">Next Post &rarr;</a>
  
  
    <a href="/fms/2014/07/04/communication-between-client-and-server" class="prev" title="communication between client and server">&larr; Earlier Post</a>
  
  </div>
  
</div><!-- End Page -->

	




  <!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1926112"></script>
<!-- UY END -->





  
  <div id="footer">
  	<address>
  		<span class="copyright">
  			Content by <a href="/info/site.html">lsj</a>. Design by 
  			<a href="http://mark.reid.name/">Mark Reid</a>
  			<br/>
  			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
  		</span>
  		<span class="engine">
  			Powered by <a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
  		</span>
  	</address>
  </div>
  
</div>



<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->

  
</body>
</html>

