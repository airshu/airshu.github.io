---
layout: post
title: 刷评论
category: 后端
tags: PHP
keywords:
description:
---


### 1.关于评论

- 评论是分表存储的,所在库comment,表cdb_comment_blog_数字,分表方案是ceil($did/600000),did是具体的动态id


### 2.如何刷评论

----

2.1.视频播放页

具体所需刷评论的视频播放页面url需运营提供

    http://www.aipai.com/c50/OjciIiErJSBqJWQuKQ.html

2.2.从视频播放页提取视频id

在视频播放页右键查看页面源码,找到:
    
    <script type="text/javascript">
        var videoInfo={
            assetId : '48233815',
            assetDid : '1800748023',
            assetBid : '66469077',
            assetClass : '1',
            assetGameid : '52350',
            appId : 15150,
            asset_url : 'http://www.aipai.com/c50/OjciIiErJSBqJWQuKQ.html',            
            assetType : 2,
            mobileUrl: 'http://m.aipai.com/m50/OjciIiErJSBqJWQuKQ.html',
            title : '《龙城学院》剑客是怎么耍贱的？|手游|自由幻想_自由幻想手游视频_爱拍原创',
            albumUrl: '',
            totalTime:'285',
            audit: '1'
        };

所需参数:

    assetId 是card.cdb_card中的id,也是blog.cdb_blog_年份 表中的dataId;
    assetDid 是具体的动态id,对应blog.cdb_blog_年份 表中的did

2.3.使用刷评论脚本

先将运营提供的评论内容列表文件内容复制到.txt文件中

    php console AipaiMessage:brush-comments -D 1800748023 -F /tmp/brush_comments_20180626.txt -Y 2018


脚本所需三个必传参数: 

    -D 是did,即动态id
    -F 是评论内容列表文件路径
    -Y 是评论发布的年份
 
 注意:
    
    1.脚本是将评论内容列表文件中的字符串按PHP_EOL拆分成数组
    2.选取评论用户是取的一年内未登陆过的前500个用户,如果运营需要一用户一评论且超过500条,需改动代码
    3.暂时只支持单一动态id