---
layout: post
title: PC版开发注意事项
category: 技术
tags: Python
keywords: 
description: 
---


**如何使用源码**

安装Python，安装PyQt5.9.1

申请gitlab账号，分配权限，	clone仓库中的源码，使用PyCharm打开。点击Edit Configuration。配置环境变量。

	PATH=%PATH%;PyQt安装目录的Qt安装目录的qmake所在目录;拍大师源码目录\bin;	
	XIAODAO_DIR=拍大师源码目录


![1](/public/img/xiaodao_config1.png)

![2](/public/img/xiaodao_config2.png)


**如何使用事件统计**

1.注册应用

	http://bingo.lagowang.com/

2.进入应用管理，选择具体某个应用的事件管理，添加事件。

![3](/public/img/xiaodao_config3.png)


3.事件记录流程

每次启动的时候先触发启动事件

DataStatisticsManager中使用对应的appkey，应用启动的时候，先触发aplan_startup事件(约定启动事件)，在具体某个触发点发送相应的事件。

	param = {}
    param["aplan_plat"] = "pc"  平台信息
    param["aplan_ak"] = self._key   应用的key
    param["aplan_ch"] = "official"  渠道
    param["aplan_uid"] = self._getMacAddress()  唯一标识
    param["aplan_sdkv"] = "1"
    param["aplan_appver"] = info.XIAODAO_VERSION  版本号
    param["aplan_et"] = "cus"
    param["aplan_eid"] = "aplan_startup"  启动事件固定ID
    param["aplan_fa"] = "1"
    param["aplan_sid"] = self.sessionId  会话ID
    param["aplan_ts"] = datetime.datetime.now().microsecond  时间戳
    _params = base64.b64encode(json.dumps(param).encode())
    self.url = "http://mlog.aipai.com/a.gif
    requests.get(self.url, params=_params, headers=my_headers)

当某个条件被触发时，发送具体的事件

	param = {}
    param["aplan_plat"] = "pc"
    param["aplan_ak"] = self._key
    param["aplan_ch"] = "official"
    param["aplan_uid"] = self._getMacAddress()
    param["aplan_sdkv"] = "1"
    param["aplan_appver"] = info.XIAODAO_VERSION
    param["aplan_et"] = "cus"
    param["aplan_eid"] = 具体事件ID
    param["aplan_fa"] = "1"
    param["aplan_sid"] = self.sessionId
    param["aplan_ts"] = datetime.datetime.now().microsecond
    _params = base64.b64encode(json.dumps(param).encode())
    self.url = "http://mlog.aipai.com/a.gif
    requests.get(self.url, params=_params, headers=my_headers)

""kibana基本使用""

进入http://bgkibana.lagowang.com:11111，点击Settings，设置appkey

![3](/public/img/kibana_1.png)

点击Ctreate，点击Discover，就选择event

![4](/public/img/kibana_2.png)

选择具体某个字段过滤

![5](/public/img/kibana_3.png)


<br/>


**如何对文件进行签名**

	拍大师源码目录\mkup\tools\sign\signtool.exe sign /f 拍大师源码目录\mkup\tools\sign\weplay.pfx /p d2bfa25a /d "GoPlay Editor" /du www.goplayeditor.com /t http://timestamp.digicert.com/td /v "动态库名字.dll"


**测试注意事项**

编译release版本会拷贝到对应的共享文件夹目录

	国内版：share_directory\xiaodao
	国际版：share_directory\goplay_videoeditor
	百度定制版：share_directory\baidu_paidashi
	Steam版：share_directory\steam_videoeditor


**如何区分渠道包**

在resources文件夹下有一个version.xml文件，里面保存了渠道ID，启动的时候会读取此文件获取渠道，当数据统计时会带上渠道信息。





