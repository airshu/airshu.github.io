---
layout: post
title: PC版发布流程
category: 技术
tags: 
keywords: 
description: 
---

PC版发布流程


**国内版更新流程**

1、编译release版

启动192.168.10.58这台机器，连接git，配置编译参数。进行编译。编译完成后的目录为

	D:\Windows\jenkins\workspace\xiaodao\mkup\release\bin

exe文件存在于

	D:\Windows\jenkins\workspace\xiaodao\mkup


2、修改bin目录下的update.xml，改成产品指定的版本号，修改更新信息(一定要使用编译出来的update.xml)

	<?xml version='1.0' encoding='utf-8'?>
	<update> 
	  <version>1.2.0</version>
	  <date>2017-01-22 13:37:21.270000</date>
	  <url>http://update.smartpixel.com/RAND/goplay/update.xml</url>
	  <base>http://update.smartpixel.com/RAND/goplay</base>
	  <answer>false</answer>
	  <changelog>
	<![CDATA[
	Notifications:
	1. Fixed "Screen recorder not running sometimes"
	2. Fixed "Searched Songs not playing sometimes" 
	3. Optimized some codes
	]]>
	</changelog>
	...

3、更新到内网nginx服务器上，目录存在于

	D:\nginx\web\xiaodao

4、内网测试更新，本地需要修改hosts，指向58的服务器

	192.168.10.58 update.aipai.com

5、使用cygwin提交到外网(为了兼容老版本更新，所以需要提交到服务器上的两个目录)

	rsync -e 'ssh -p 33222' -azP * zhaolong@183.2.220.11:/srv/client/xiaodao
	scp  -P33222  update.xml  zhaolong@183.2.220.11:/srv/client/xiaodao/update.xml
	ssh  -p33222  zhaolong@183.2.220.11 "chmod 777 /srv/client/xiaodao/*  -Rf"
	scp  -P33222  update.xml  yixin@183.2.220.11:/srv/client/files/update.xml
	ssh  -p33222  yixin@183.2.220.11  "chmod 777 /srv/client/files/* -Rf"

	
**国际版更新流程**


1、编译release版

启动192.168.10.58这台机器，连接git，配置编译参数。进行编译。编译完成后的目录为

	D:\Windows\jenkins\workspace\goplay_videoeditor\mkup\release\bin

exe文件存在于

	D:\Windows\jenkins\workspace\goplay_videoeditor\mkup


2、修改bin目录下的update.xml，改成产品指定的版本号，修改更新信息

	<?xml version='1.0' encoding='utf-8'?>
	<update> 
	  <version>1.2.0</version>
	  <date>2017-01-22 13:37:21.270000</date>
	  <url>http://update.smartpixel.com/RAND/goplay/update.xml</url>
	  <base>http://update.smartpixel.com/RAND/goplay</base>
	  <answer>false</answer>
	  <changelog>
	<![CDATA[
	Notifications:
	1. Fixed "Screen recorder not running sometimes"
	2. Fixed "Searched Songs not playing sometimes" 
	3. Optimized some codes
	]]>
	</changelog>
	...

3、更新到内网nginx服务器上，目录存在于

	D:\nginx\web\goplay

4、内网测试更新，本地需要修改hosts，指向58的服务器

	192.168.10.58 update.smartpixel.com


5、直接将安装文件和编译后的bin目录直接发给后端同事更新。(提交国外服务器速度很慢)



**注意事项**

* 确定使用的数据统计的key是否为release版本
* 确定软件通过诺顿等杀毒软件的检测










